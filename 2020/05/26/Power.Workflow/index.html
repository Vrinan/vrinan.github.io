<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Vrinan">


    <meta name="subtitle" content="最后存活着的房门被敲">


    <meta name="description" content="最后存活着的房门被敲">



<title>Power.Workflow | 最后存活着的房门被敲</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 4.2.1"></head>
<body>
    <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
    <!-- <script type="text/javascript" src="//raw.githubusercontent.com/alroy233/alroy233.github.io/master/scriptAl/canvas-nest.min.js"></script> -->
    <div class="wrapper">
        <header>
    <!-- alroy -->
    <script type="text/javascript">
        WIDGET = { FID: 'JAnPUETnam' }
    </script>
    <script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/"></a></div>
            <div class="menu navbar-right">
                
                <a class="menu-item" href="/index">Home</a>
                
                <a class="menu-item" href="/categories">Categories</a>
                
                <a class="menu-item" href="/tags">Tags</a>
                
                <a class="menu-item" href="/Aimer">Nier</a>
                
                <a class="menu-item" href="/about">ひむら きせき</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/"></a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                <a class="menu-item" href="/index">Home</a>
                
                <a class="menu-item" href="/categories">Categories</a>
                
                <a class="menu-item" href="/tags">Tags</a>
                
                <a class="menu-item" href="/Aimer">Nier</a>
                
                <a class="menu-item" href="/about">ひむら きせき</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Power.Workflow</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Vrinan</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">May 26, 2020&nbsp;&nbsp;17:28:24</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Power/">Power</a>
                            
                        </span>
                    
                    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=468490600&auto=1&height=32"></iframe>
                </div>
            
        </header>
        <div class="post-content">
            <h1 id="1、流程自定义"><a href="#1、流程自定义" class="headerlink" title="1、流程自定义"></a>1、流程自定义</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;1.1、发送操作提取待选人员后事件</span><br><span class="line">&#x2F;&#x2F;获取流程实例Id（字段）</span><br><span class="line">string sWorkInfoID &#x3D; this.WorkFlowCenter.CurInstance.WorkInfoID; </span><br><span class="line">this.WorkFlowCenter.FormCenter.CheckInfo(sWorkInfoID);</span><br><span class="line">FormCenter formCenter &#x3D; this.WorkFlowCenter.FormCenter as FormCenter;</span><br><span class="line">string KeyValue &#x3D; formCenter.bus[&quot;Id&quot;].ToString() ;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;获取到了采购物资的类型bbs[&quot;ProfessionId&quot;]主键KeyValue</span><br><span class="line">Power.Business.IBaseBusiness bbs &#x3D; Power.Business.BusinessFactory.CreateBusinessOperate(&quot;SF_TechnicalDocuments&quot;).FindByKey(KeyValue);</span><br><span class="line">&#x2F;&#x2F;sql语句查出对应的人员</span><br><span class="line">StringBuilder sbSQL &#x3D; new StringBuilder();</span><br><span class="line">sbSQL.Append(&quot;select * from View_SF_DesignBom where DesignMajorId&#x3D;&#39;&quot;+bbs[&quot;ProfessionId&quot;]+&quot;&#39; and ProjectMessageId&#x3D;&#39;&quot;+bbs[&quot;ProjectMessageId&quot;]+&quot;&#39; and DesignStage &#x3D; &#39;&quot;+Convert.ToString(bbs[&quot;ProjectPhase&quot;])+&quot;&#39;&quot;);</span><br><span class="line">System.Data.DataTable dtTemp &#x3D; XCode.DataAccessLayer.DAL.QuerySQL(sbSQL.ToString());</span><br><span class="line">if (dtTemp !&#x3D; null &amp;&amp; dtTemp.Rows.Count !&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line"> for (int i &#x3D; 0; i &lt;&#x3D; dtTemp.Rows.Count - 1; i++)</span><br><span class="line"> &#123;</span><br><span class="line">     &#x2F;&#x2F;根据负责人Id查出人员表信息</span><br><span class="line">     Power.Business.IBaseBusiness bbsHuman &#x3D; Power.Business.BusinessFactory.CreateBusinessOperate(&quot;Human&quot;).FindByKey(Convert.ToString(dtTemp.Rows[i][&quot;ProofreaderId&quot;]));</span><br><span class="line">     </span><br><span class="line">     Power.WorkFlows.Interface.User.IUserInfo userInfo &#x3D; new Power.WorkFlows.Core.UserInfo(Power.WorkFlows.Enums.ESourceMode.DeptAndUser);</span><br><span class="line">     userInfo.UserID &#x3D; Convert.ToString(bbsHuman[&quot;Id&quot;]);</span><br><span class="line">     userInfo.UserName &#x3D; Convert.ToString(bbsHuman[&quot;Name&quot;]);</span><br><span class="line">     &#x2F;&#x2F;追加部门信息</span><br><span class="line">     userInfo.SourceMode &#x3D; Power.WorkFlows.Enums.ESourceMode.DeptAndUser;</span><br><span class="line">     userInfo.DeptPositionID &#x3D; Convert.ToString(bbsHuman[&quot;PosiId&quot;]);</span><br><span class="line">     userInfo.DeptPositionName &#x3D; Convert.ToString(bbsHuman[&quot;PosiName&quot;]);</span><br><span class="line">     &#x2F;&#x2F; IUserInfo 是基本用户信息，   ISendUser 是发送时用户信息,   另有 IReturnUser 是驳回时用户信息 ,各自对应不同的场景</span><br><span class="line">     Power.WorkFlows.Interface.Trans.ISendUser sendUser &#x3D; new Power.WorkFlows.Core.Trans.TSendUser();</span><br><span class="line">     sendUser.Fill(userInfo);  &#x2F;&#x2F;填充</span><br><span class="line">     e.SelectedNode.CanSelectUsers.Add(sendUser);   &#x2F;&#x2F;人员加入列表容器中</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 2、自定义流程</span><br><span class="line">string guid &#x3D; System.Guid.NewGuid().ToString();</span><br><span class="line">Power.WorkFlows.Actions.WorkFlowAction flowAction &#x3D; new Power.WorkFlows.Actions.WorkFlowAction();</span><br><span class="line">&#x2F;&#x2F;创建流程</span><br><span class="line">string liucheng1 &#x3D; &quot;&#123;\&quot;Current\&quot;:&#123;\&quot;WorkFlowID\&quot;:\&quot;5c4f92bc-6566-49e4-896e-15dafa8d7b8f\&quot;,\&quot;Version\&quot;:\&quot;1.0.0.1\&quot;,\&quot;FormId\&quot;:\&quot;b9fb69d5-d989-42e5-9373-500998d52b21\&quot;,\&quot;KeyWord\&quot;:\&quot;test_liucheng\&quot;,\&quot;KeyValue\&quot;:\&quot;&quot; + KeyValue + &quot;\&quot;,\&quot;WorkInfoID\&quot;:\&quot;&quot; + guid + &quot;\&quot;&#125;,\&quot;FlowOperate\&quot;:\&quot;&quot; + Power.WorkFlows.Enums.EFlowOperate.Active.ToString() + &quot;\&quot;&#125;&quot;;</span><br><span class="line">flowAction.Execute(liucheng1);</span><br><span class="line">&#x2F;&#x2F;按指定人发起流程</span><br><span class="line">string liucheng2 &#x3D; &quot;&#123;\&quot;Current\&quot;:&#123;\&quot;WorkInfoID\&quot;:\&quot;&quot; + guid + &quot;\&quot;,\&quot;WorkFlowID\&quot;:\&quot;5c4f92bc-6566-49e4-896e-15dafa8d7b8f\&quot;,\&quot;Version\&quot;:\&quot;1.0.0.1\&quot;,\&quot;NodeCode\&quot;:\&quot;demo_node_1\&quot;,\&quot;NodeName\&quot;:\&quot;开始\&quot;,\&quot;SequeID\&quot;:1,\&quot;PlanEndDate\&quot;:\&quot;&quot; + DateTime.Now.ToString() + &quot;\&quot;,\&quot;FormId\&quot;:null,\&quot;KeyWord\&quot;:null,\&quot;KeyValue\&quot;:null&#125;,\&quot;SelectedNode\&quot;:[&#123;\&quot;SendUserList\&quot;:[&#123;\&quot;UserID\&quot;:\&quot;2d5defb3-f3b7-4b7c-a68e-56afa901801a\&quot;,\&quot;SourceUserID\&quot;:\&quot;2d5defb3-f3b7-4b7c-a68e-56afa901801a\&quot;,\&quot;UserName\&quot;:\&quot;潘钟跃\&quot;,\&quot;SourceUserName\&quot;:\&quot;潘钟跃\&quot;,\&quot;DeptPositionID\&quot;:\&quot;10c166ad-52ad-49ed-959f-ae1bd3677644\&quot;,\&quot;DeptPositionName\&quot;:\&quot;计划控制室\&quot;,\&quot;SourceMode\&quot;:10&#125;],\&quot;CopyUserList\&quot;:[],\&quot;NodeCode\&quot;:\&quot;demo_node_2\&quot;&#125;],\&quot;MindInfo\&quot;:\&quot;\&quot;,\&quot;VoteValue\&quot;:\&quot;\&quot;,\&quot;VoteText\&quot;:\&quot;\&quot;,\&quot;FlowOperate\&quot;:\&quot;&quot; + Power.WorkFlows.Enums.EFlowOperate.Send.ToString()+ &quot;\&quot;&#125;&quot;;</span><br><span class="line">flowAction.Execute(liucheng2);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;&#x3D;&#x3D;&#x3D;&#x3D;多人流程&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">string flowguid &#x3D; System.Guid.NewGuid().ToString();</span><br><span class="line">Power.WorkFlows.Actions.WorkFlowAction flowAction &#x3D; new Power.WorkFlows.Actions.WorkFlowAction();</span><br><span class="line">&#x2F;&#x2F;创建流程</span><br><span class="line">string liucheng1 &#x3D; &quot;&#123;\&quot;Current\&quot;:&#123;\&quot;WorkFlowID\&quot;:\&quot;25944DA2-7A45-BD48-067A-62B75D191B98\&quot;,\&quot;Version\&quot;:\&quot;1.0.0.1\&quot;,\&quot;FormId\&quot;:\&quot;c22350a3-7057-40f6-885f-0eba68347815\&quot;,\&quot;KeyWord\&quot;:\&quot;XMGL_HQC_MPH_orderman\&quot;,\&quot;KeyValue\&quot;:\&quot;&quot; + HQC_MPH_orderman_ID + &quot;\&quot;,\&quot;WorkInfoID\&quot;:\&quot;&quot; + flowguid + &quot;\&quot;&#125;,\&quot;FlowOperate\&quot;:\&quot;&quot; + Power.WorkFlows.Enums.EFlowOperate.Active.ToString() + &quot;\&quot;&#125;&quot;;</span><br><span class="line">flowAction.Execute(liucheng1);</span><br><span class="line">&#x2F;&#x2F;按指定人发起流程(多人)</span><br><span class="line">string liucheng2 &#x3D; &quot;&#123;\&quot;Current\&quot;:&#123;\&quot;WorkInfoID\&quot;:\&quot;&quot; + flowguid + &quot;\&quot;,\&quot;WorkFlowID\&quot;:\&quot;25944DA2-7A45-BD48-067A-62B75D191B98\&quot;,\&quot;Version\&quot;:\&quot;1.0.0.1\&quot;,\&quot;NodeCode\&quot;:\&quot;demo_node_1\&quot;,\&quot;NodeName\&quot;:\&quot;开始\&quot;,\&quot;SequeID\&quot;:1,\&quot;PlanEndDate\&quot;:\&quot;&quot; + DateTime.Now.ToString() + &quot;\&quot;,\&quot;FormId\&quot;:null,\&quot;KeyWord\&quot;:null,\&quot;KeyValue\&quot;:null&#125;,\&quot;SelectedNode\&quot;:[&#123;\&quot;SendUserList\&quot;:[&quot;;</span><br><span class="line">&#x2F;&#x2F;循环</span><br><span class="line">string liuchengsql &#x3D; &quot;&quot;;&#x2F;&#x2F;sql语句</span><br><span class="line">System.Data.DataTable UserDt &#x3D; XCode.DataAccessLayer.DAL.QuerySQL(liuchengsql); &#x2F;&#x2F;执行</span><br><span class="line">if (UserDt.Rows.Count &gt; 0)</span><br><span class="line">&#123;</span><br><span class="line">	for (int i &#x3D; 0; i &lt; UserDt.Rows.Count; i++)</span><br><span class="line">	&#123;</span><br><span class="line">        string HumanId &#x3D; UserDt.Rows[i][&quot;HumanId&quot;].ToString();</span><br><span class="line">        string HumanName &#x3D; UserDt.Rows[i][&quot;HumanName&quot;].ToString();</span><br><span class="line">        string DeptId &#x3D; UserDt.Rows[i][&quot;DeptId&quot;].ToString();</span><br><span class="line">        string DeptName &#x3D; UserDt.Rows[i][&quot;DeptName&quot;].ToString();</span><br><span class="line"></span><br><span class="line">        liucheng2 +&#x3D; &quot;&#123;\&quot;UserID\&quot;:\&quot;&quot; + HumanId + &quot;\&quot;,\&quot;SourceUserID\&quot;:\&quot;&quot; + HumanId + &quot;\&quot;,\&quot;UserName\&quot;:\&quot;&quot; + HumanName + &quot;\&quot;,\&quot;SourceUserName\&quot;:\&quot;&quot; + HumanName + &quot;\&quot;,\&quot;DeptPositionID\&quot;:\&quot;&quot; + DeptId + &quot;\&quot;,\&quot;DeptPositionName\&quot;:\&quot;&quot; + DeptName + &quot;\&quot;,\&quot;SourceMode\&quot;:10&#125;,&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    liucheng2 &#x3D; liucheng2.TrimEnd(&#39;,&#39;);</span><br><span class="line">    liucheng2 +&#x3D; &quot;],\&quot;CopyUserList\&quot;:[],\&quot;NodeCode\&quot;:\&quot;demo_node_2\&quot;&#125;],\&quot;MindInfo\&quot;:\&quot;\&quot;,\&quot;VoteValue\&quot;:\&quot;\&quot;,\&quot;VoteText\&quot;:\&quot;\&quot;,\&quot;FlowOperate\&quot;:\&quot;&quot; + Power.WorkFlows.Enums.EFlowOperate.Send.ToString() + &quot;\&quot;&#125;&quot;;</span><br><span class="line">    flowAction.Execute(liucheng2);</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;&#x3D;&#x3D;&#x3D;&#x3D;在PMS里面通过代码自动获取审批人员列表&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">private void bushizhuren_onSendNodeUserSelect(Object sender, SendNodeUserSelectArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;获取流程对应的表单信息</span><br><span class="line">    string sWorkInfoID &#x3D; this.WorkFlowCenter.CurInstance.WorkInfoID;</span><br><span class="line">    this.WorkFlowCenter.FormCenter.CheckInfo(sWorkInfoID);    &#x2F;&#x2F;验证下keyValue&#x2F;keyWord 是否存在，不存在就补全</span><br><span class="line">    FormCenter formCenter &#x3D; this.WorkFlowCenter.FormCenter as FormCenter;</span><br><span class="line">    string KeyWord &#x3D; formCenter.FormInfo.KeyWord;</span><br><span class="line">    string FormId &#x3D; formCenter.FormInfo.FormId;</span><br><span class="line">    string KeyValue &#x3D; formCenter.FormInfo.KeyValue;</span><br><span class="line">	</span><br><span class="line">	&#x2F;&#x2F;选择业务数据</span><br><span class="line">    string dept_human_ID &#x3D; &quot;&quot;, projinfo_ID &#x3D; &quot;&quot;;</span><br><span class="line">    string sql &#x3D;&quot;select * from V_PS_CH_CehuaStatus where projinfo_id like 20% order by plandata_id src&quot;</span><br><span class="line">    string sql &#x3D; &quot;select dept_human_ID,projinfo_ID from HQC_MPH_orderman where HQC_MPH_orderman_ID&#x3D;&#39;&quot; + KeyValue + &quot;&#39;&quot;;</span><br><span class="line">    System.Data.DataTable sqlDt &#x3D; XCode.DataAccessLayer.DAL.QuerySQL(sql); &#x2F;&#x2F;执行</span><br><span class="line">    for (int i &#x3D; 0; i &lt; sqlDt.Rows.Count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        dept_human_ID &#x3D; sqlDt.Rows[i][&quot;dept_human_ID&quot;].ToString();</span><br><span class="line">        projinfo_ID &#x3D; sqlDt.Rows[i][&quot;projinfo_ID&quot;].ToString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;添加选择人员</span><br><span class="line">    string strsql &#x3D; &quot;&quot;;&#x2F;&#x2F;获取人员信息sql语句，必须包括HumanId、HumanName、部门ID，部门名称</span><br><span class="line">    System.Data.DataTable UserDt &#x3D; XCode.DataAccessLayer.DAL.QuerySQL(strsql); &#x2F;&#x2F;执行</span><br><span class="line">    for (int i &#x3D; 0; i &lt; UserDt.Rows.Count;i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        string HumanId &#x3D; UserDt.Rows[i][&quot;HumanId&quot;].ToString();</span><br><span class="line">        string HumanName &#x3D; UserDt.Rows[i][&quot;HumanName&quot;].ToString();</span><br><span class="line">        string DeptId &#x3D; UserDt.Rows[i][&quot;DeptId&quot;].ToString();</span><br><span class="line">        string DeptName &#x3D; UserDt.Rows[i][&quot;DeptName&quot;].ToString();</span><br><span class="line">        &#x2F;&#x2F;循环插入人员(如果人员固定，直接写下面的，就不用循环，人员写死也行)</span><br><span class="line">        Power.WorkFlows.Interface.User.IUserInfo userInfo &#x3D; new UserInfo(Power.WorkFlows.Enums.ESourceMode.DeptAndUser);</span><br><span class="line">        userInfo.UserID &#x3D; HumanId;</span><br><span class="line">        userInfo.UserName &#x3D; HumanName;</span><br><span class="line">        &#x2F;&#x2F;追加部门信息</span><br><span class="line">        userInfo.SourceMode &#x3D; Power.WorkFlows.Enums.ESourceMode.DeptAndUser;</span><br><span class="line">        userInfo.DeptPositionID &#x3D; DeptId;</span><br><span class="line">        userInfo.DeptPositionName &#x3D; DeptName;</span><br><span class="line"></span><br><span class="line">        Power.WorkFlows.Interface.Trans.ISendUser sendUser &#x3D; new Power.WorkFlows.Core.Trans.TSendUser();</span><br><span class="line">        sendUser.Fill(userInfo);  &#x2F;&#x2F;填充</span><br><span class="line"></span><br><span class="line">        e.SelectedNode.CanSelectUsers.Add(sendUser);   &#x2F;&#x2F;人员加入列表容器中</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/Power/"># Power</a>
                    
                        <a href="/tags/Net/"># .Net</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2020/05/26/Power.Template/">Power.Template</a>
            
            
            <a class="next" rel="next" href="/2020/05/26/Tech.SqlServer/">Tech.SqlServer</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <!-- <span>© Vrinan|Powered by Hexo</span> -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">x<span id="busuanzi_value_site_pv"></span></span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv">s<span id="busuanzi_value_site_uv"></span></span>
    </div>
</footer>
    </div>
</body>
</html>
